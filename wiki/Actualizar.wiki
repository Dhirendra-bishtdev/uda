#summary Actualizar a la última versión disponible
#labels Phase-Deploy,Featured

En esta sección iremos indicando como mantenerse actualizado con las últimas versiones disponibles de los componentes de <img src="http://uda.googlecode.com/svn/wiki/images/uda-mini-micro2.png"/>, es decir, cuando ya se dispone de una aplicación generada, y se desea incorporar las últimas actualizaciones.
<p> 
Si lo que buscas es información sobre como mantener tu entorno de desarrollo actualizado, debes consultar la sección [http://code.google.com/p/uda/wiki/Instalar "Instalar"]. 

<h3>v1.1.1 (14-Octubre-2011)</h3>
<ol>
<li>Cambiar la carpeta {{{xxxStatics}}}\WebContent\rup por la carpeta incluida en el fichero [http://uda.googlecode.com/files/rup-v1.1.1.zip rup-v1.1.1.zip]</li>
<li>Modificar la inclusión de los ficheros CSS y JS:

    {{{<xxxYYY>}}}War\WebContent\WEB-INF\layouts\includes\rup.styles.inc (líneas 9-24):
{{{
<!-- Patrones (basic-theme) -->
<link href="${staticsUrl}/rup/basic-theme/theme.rup.base-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.autocomplete-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.breadCrumb-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.combo-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.date-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.feedback-1.1.0.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.grid-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.lang-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.maint-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.menu-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.messages-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.tabs-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.time-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.toolbar-1.1.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.tooltip-1.1.1.css" rel="stylesheet" type="text/css" />
}}}
			
    {{{<xxxYYY>}}}\WebContent\WEB-INF\layouts\includes\rup.scripts.inc (líneas 6-8 y 29-44):
{{{
<!-- RUP-CORE -->
<script src="${staticsUrl}/rup/scripts/rup.utils-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.base-1.1.1.js" type="text/javascript"></script>

...

<!-- Patrones RUP -->
<script src="${staticsUrl}/rup/scripts/rup.autocomplete-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.breadCrumb-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.combo-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.date-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.dialog-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.feedback-1.1.0.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.grid-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.lang-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.maint-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.menu-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.message-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.tabs-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.time-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.toolbar-1.1.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.tooltip-1.1.1.js" type="text/javascript"></script>
}}}
</li>			

    **NOTA: Los ficheros actualizados puedes obtenerlos desde [http://uda.googlecode.com/files/templates-v1.1.1.zip templates-v1.1.1.zip] 

<li>Si estás construyendo una aplicación para EJIE que además debe ser integrada en alguno de los portales de euskadi.net, debes actualizar el fichero {{{xxxEAR\build.xml}}} que incluye la nueva utilidad de generación de estilos (generatePortalStatic). Haciendo uso de dicha utilidad evitarás posibles problemas en el momento de integrar tu aplicación en el portal.

{{{
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project>
<project name="aaaEAR" default="mavenRunDependencies" xmlns:artifact="antlib:org.apache.maven.artifact.ant">
	
	<!-- Permite el uso de variables de entorno -->
	<property environment="env" />
		
	<!-- Obtener dependencias -->	
	<target name="mavenRunDependencies" description="Resuelve las dependencias del proyecto desde Maven">
		<path id="maven-ant-tasks.classpath" path="${ant.home}/lib/maven-ant-tasks-2.1.1.jar" />
		<typedef resource="org/apache/maven/artifact/ant/antlib.xml" uri="antlib:org.apache.maven.artifact.ant" classpathref="maven-ant-tasks.classpath" />	
		<artifact:dependencies settingsFile="${env.M2_HOME}/conf/settings.xml"/>
		<artifact:mvn pom="pom.xml" mavenHome="${env.M2_HOME}" fork="true">
			<arg value="package"/>
		</artifact:mvn>		
	</target>
	
	<!-- Portalizar estilos -->
	<property name="codApp" value="aaa"/>
	<property name="srcDir" value="../${codApp}Statics/WebContent"/>
	<property name="destDir" value="../${codApp}Statics/${codApp}PortalStatics"/>

	<target name="generatePortalStatics" description="Genera directorio aaaPortalStatics para despliegue en portal">
		<echo>Regenerando directorio (aaaPortalStatics)</echo>
		<delete dir="${destDir}" />
		<mkdir  dir="${destDir}" />
		<copy todir="${destDir}/rup" >
	 		<fileset dir="${srcDir}/rup" />
		</copy>
		<copy todir="${destDir}/${codApp}" >
			<fileset dir="${srcDir}/${codApp}" />
		</copy>
		
		<!-- Desplegar en LOCAL -->
		<copy todir="${destDir}/WEB-INF" >
			<fileset dir="${srcDir}/WEB-INF" />
		</copy>
		<replace file="${destDir}/WEB-INF/weblogic.xml" token="${codApp}Statics" value="${codApp}PortalStatics" />
		
		
		<echo>Parseando ficheros de estilos (.css)</echo>
		<taskdef name="portalizeCss" classname="com.ejie.uda.UDAPortalizeCss" classpath="${ant.home}/lib/com.ejie.uda.statics.tools.jar" />
		<portalizeCss codApp="${codApp}" destDir="${destDir}" parserHacks="${ant.home}/lib/com.ejie.uda.statics.tools.style_hacks"/>
	</target>

</project>
}}} 

Acuérdate de sustituir el valor de la etiqueta {{{value}}} de la línea {{{<property name="codApp" value="aaa"/>}}} por el código de tu aplicación, así como el nombre del proyecto {{{<project name="aaaEAR" }}} al principio del fichero.

    **NOTA: Las librerías que contienen esta utilidad se instalarán cuando actualices el [http://uda.googlecode.com/files/pluginUDAInstall-v1.1.1.zip Plugin UDA (v1.1.1)], por tanto, para poder utilizarla, debes realizar antes dicha [http://code.google.com/p/uda/wiki/Instalar instalación].  

</li>

<li>Actualizar el repositorio de dependencias Maven con la nueva [http://uda.googlecode.com/files/MavenRepository-v1.1.1.zip versión 1.1.1], que contiene  las nuevas versiones de las librerias actualizadas (x38ShLibClasses-1.1.1.jar e hibernate-validator-4.2.0.Final)</li>

<li>Actualizar el fichero "{{{pom.xml}}}" del proyecto {{{xxxEAR}}} para dejar acorde las dependencias de las librerías:

<ul>
<li>Actualizar la versión de x38:
{{{
<dependency>
    ...
    ...
    <com.ejie.x38.version>1.1.1</com.ejie.x38.version>
</dependency>

...

<!-- x38 -->
<dependency>
    <groupId>com.ejie.x38</groupId>
    <artifactId>x38ShLibClasses</artifactId>
    <version>1.1.1</version>
</dependency>
}}}
</li>

<li>Actualizar la versión de Hibernate Validator:
{{{
<!-- JSR 303 with Hibernate Validator -->
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator</artifactId>
    <version>4.2.0.Final</version>
</dependency>
}}}
</li>
<li>Abre el "{{{build.xml}}}" del proyecto {{{xxxEAR}}} con el editor ant (botón derecho sobre el fichero, Open With>Ant Editor)</li>
<li>Ejecuta la tarea "mavenRunDependencies" (botón derecho sobre la tarea, Run As>Ant Build) actualizando las nuevas librerías {{{xxxEAR\APP_INF\lib}}}</li>
<li>Sobre el proyecto {{{xxxEAR}}} pulsa F5 (Refresh)</li>
</ul>
</li>
<li>
En la configuración del sistema de logging, en el fichero {{{xxxConfig\logback.xml}}}, corregir el appender de trazas de la aplicación.
    Donde aparece 
{{{
	<logger name="com.ejie.${CONTEXT_NAME}" level="${log.level.aplicTrazas}">
		<appender-ref ref="aplicTrazasAppender"/>
	</logger>
}}}

    Sustituir {{{${CONTEXT_NAME}}}} por el código de tu aplicación para que en el fichero se escriban las trazas de la aplicación.
</li>
<li>No olvides actualizar también el [http://uda.googlecode.com/files/pluginUDAInstall-v1.1.1.zip Plugin UDA (v1.1.1)] y las [http://uda.googlecode.com/files/templates-v1.1.1.zip Plantillas (v1.1.1)], o si lo prefieres el [http://code.google.com/p/uda/downloads/list Eclipse Helios UDA (v1.1.1)] completo. Es más, si no lo haces, no funcionará la utilidad de generación de estilos para integrar tu aplicación en la red de portales euskadi.net.
</li>
</ol>

<h3>v1.1.0 (15-Septiembre-2011)</h3>

<ol>
<li>Actualizar la estructura de proyectos

<ul>
<li>
*EARClasses:*

Se ha cambiado la ruta de los ficheros de configuración de Spring (se han sacado del directorio META-INF):

Antes:
{{{
xxxEARClasses/src/META-INF/spring/
}}}
Ahora:
{{{
xxxEARClasses/src/spring/
}}}

Esta modificación produce cambios en cadena en el fichero "{{{xxxEARClasses/src/beanRefContext.xml}}}":

Antes:
{{{
<value>META-INF/spring/dao-config.xml</value> 
<value>META-INF/spring/log-config.xml</value>
<value>META-INF/spring/service-config.xml</value>
<value>META-INF/spring/security-config.xml</value>
<value>META-INF/spring/tx-config.xml</value>
}}}
Ahora: 
{{{
<value>spring/dao-config.xml</value> 
<value>spring/log-config.xml</value>
<value>spring/service-config.xml</value>
<value>spring/security-config.xml</value>	
<value>spring/tx-config.xml</value>
}}}
</li>

<li>
*Statics:*

El fichero de carga del layout ha cambiado de ruta:

Antes:
{{{
xxxStatics/WebContent/xxx/scripts/layoutLoaderXxxWARNAME.js
}}}
Ahora:
{{{
xxxStatics/WebContent/xxx/scripts/WARNAME/layoutLoader.js
}}}

Esta modificación produce cambios en cadena en el fichero "{{{xxxNombreWar/WebContent/WEB-INF/layouts/base-includes.jsp}}}":

Antes:
{{{
<script src="${staticsUrl}/xxx/scripts/layoutLoaderXXXPilotoPatrones.js" type="text/javascript"></script>
}}}
Ahora:
{{{
<script src="${staticsUrl}/xxx/scripts/WARNAME/layoutLoader.js" type="text/javascript"></script>
}}}

NOTA: Donde se indica "WARNAME" es el nombre del War sin código de aplicación y sin la terminación "War" (Ej. De {{{x21aPilotoPatronesWar}}} sería {{{PilotoPatrones}}})
</li>
 
<li>
*War:*

El fichero de inclusión de TLDs y definición de variables estáticas ha cambiado de ruta (se ha sacado del directorio {{{views/includes}}}):

Antes:
{{{
…/WEB-INF/views/includes/includeTemplate.inc
}}}
Ahora:
{{{
…/WEB-INF/includeTemplate.inc
}}}

Esta modificación produce cambios en cadena en los ficheros:
<ul>
<li>{{{xxxNombreWar/WebContent/WEB-INF/layouts/base-includes.jsp}}}</li>
<li>{{{xxxNombreWar/WebContent/WEB-INF/layouts/header.jsp}}}</li>
<li>{{{xxxNombreWar/WebContent/WEB-INF/layouts/template.jsp}}}</li>
<li>Páginas generadas con el plugin de mantenimiento</li>
<ul>
<li>{{{xxxNombreWar/WebContent/WEB-INF/views/aaa/aaa-includes.jsp}}}</li>
<li>{{{xxxNombreWar/WebContent/WEB-INF/views/aaa/aaa.jsp}}}</li>
</ul>
</ul>

Antes:
{{{
<%@include file="/WEB-INF/views/includes/includeTemplate.inc"%>
}}}
Ahora:
{{{
<%@include file="/WEB-INF/includeTemplate.inc"%>
}}}

Se añaden nuevos ficheros para facilitar la inclusión de los estáticos y son los siguientes ficheros:

<ul>
<li>{{{…/WEB-INF/layouts/includes/rup.scripts.inc}}} (Scripts de RUP)</li>
<li>{{{…/WEB-INF/layouts/includes/rup.styles.inc}}} (Estilos de RUP)</li>
<li>{{{…/WEB-INF/layouts/includes/xxx.scripts.inc}}} (Scripts de la aplicación)</li> 
<li>{{{…/WEB-INF/layouts/includes/xxx.styles.inc}}} (Estilos de la aplicación)</li>
</ul>

NOTA: Estos ficheros están incluidos en las plantillas [http://uda.googlecode.com/files/templates-v1.1.0.zip templates-v1.1.0.zip], en la carpeta "{{{templates\war\WebContent\WEB-INF\layouts\includes}}}"

Esta modificación produce cambios en cadena en el fichero "{{{xxxNombreWar/WebContent/WEB-INF/layouts/base-includes.jsp}}}":

	
Antes:
{{{
<!-- jQuery 1.4.4 -->
<script src="<#noparse>${staticsUrl}</#noparse>/rup/scripts/core/jquery-1.4.4.js" type="text/javascript"></script>

<!-- RUP-CORE -->
<script src="<#noparse>${staticsUrl}</#noparse>/rup/scripts/rup.utils-1.0.1.js" type="text/javascript"></script>
<script src="<#noparse>${staticsUrl}</#noparse>/rup/scripts/rup.base-1.0.1.js" type="text/javascript"></script>
			...
}}}
Ahora:
{{{
<%@include file="/WEB-INF/layouts/includes/rup.scripts.inc"%>
<%@include file="/WEB-INF/layouts/includes/xxx.scripts.inc"%>
}}}

Además también se producen cambios en el fichero "{{{xxxNombreWar/WebContent/WEB-INF/layouts/base-head.jsp}}}":
		
Antes:
{{{
<!-- BASE (sub-productos para patrones) -->
<link href="<#noparse>${staticsUrl}</#noparse>/rup/basic-theme/ui.jqgrid.css" rel="stylesheet" type="text/css" />

<!-- jQuery UI (custom-theme) -->
<link href="<#noparse>${staticsUrl}</#noparse>/rup/custom-theme/jquery-ui-1.8.13.custom.css" rel="stylesheet" type="text/css" />
			...
}}}
Ahora:
{{{
<%@include file="/WEB-INF/layouts/includes/rup.styles.inc"%>
<%@include file="/WEB-INF/layouts/includes/xxx.styles.inc"%>
}}}		
	
NOTA: Para utilizar los ficheros .inc se deberán actualizar también los componentes visuales (RUP) a la [http://uda.googlecode.com/files/rup-v1.1.0.zip versión 1.1.0].		
</li>
</ul>
</li>

<li>Migración del sistema de trazas de LOG4J a SLF4J y LOGBack
<ul>

<li>Para que en nuevo sistema de trazas funcione correctamente, es necesario actualizar las siguientes librerías ubicadas en el proyecto EAR de la aplicación:

<img src="http://uda.googlecode.com/svn/wiki/images/img1.JPG"/>

<ul>
<li>Actualizar la librería de UDA a la última versión [http://uda.googlecode.com/files/x38ShLibClasses-1.1.0.jar x38ShLibClasses-1.1.0.jar] para tener el código del nuevo sistema de trazas de UDA.</li>
<li>Cambiar las librerías de LOG4J por las de SLF4J y LOGBack:

Borrar las librerías {{{log4j-1.2.16.jar}}} y {{{slf4j-log4j12-1.6.1.jar}}}, y añadir las librerías {{{slf4j-ext-1.6.1.jar}}}, {{{logback-classic-0.9.29.jar}}}, {{{logback-core-0.9.29.jar}}}, {{{jcl-over-slf4j-1.6.1.jar}}}, {{{jdbcdslog-1.0.5.jar}}} y {{{slf4j-api-1.6.1.jar}}} (estas pueden obtenerse desde el fichero de [http://uda.googlecode.com/files/MavenRepository-v1.1.0.zip repositorio Maven 1.1.0 suministrado]) 

<li>Cambiar el fichero "{{{pom.xml}}}" del proyecto EAR para dejar acorde las dependencias de las librerías:

Antes:
{{{
<org.log4j.version>1.2.16</org.log4j.version> 
}}}
Ahora:
{{{
<org.logback.version>0.9.29</org.logback.version>
}}}

También se deben sustituir los siguientes bloques de dependencias:

Antes:
{{{
<!-- Logging -->
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>${org.slf4j.version}</version>
</dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>jcl-over-slf4j</artifactId>
    <version>${org.slf4j.version}</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-log4j12</artifactId>
    <version>${org.slf4j.version}</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>log4j</groupId>
    <artifactId>log4j</artifactId>
    <version>${org.log4j.version}</version>
    <scope>runtime</scope>
</dependency>

<!-- x38 -->
<dependency>
    <groupId>com.ejie.x38</groupId>
    <artifactId>x38ShLibClasses</artifactId>
    <version>1.0.1</version>
</dependency>
}}}
Ahora:
{{{
<!-- Logging -->

<!-- SLF4J -->
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>jcl-over-slf4j</artifactId>
    <version>${org.slf4j.version}</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>${org.slf4j.version}</version>
</dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-ext</artifactId>
    <version>${org.slf4j.version}</version>
    <exclusions>
    <!-- Exclude Compiler assisted localization library (CAL10N) -->
       <exclusion>
          <groupId>ch.qos.cal10n</groupId>
          <artifactId>cal10n-api</artifactId>
       </exclusion>                       
    </exclusions> 
</dependency>

<!-- Logback -->
<dependency>
    <groupId>ch.qos.logback</groupId>
    <artifactId>logback-core</artifactId>
    <version>${org.logback.version}</version>
</dependency>
<dependency>
    <groupId>ch.qos.logback</groupId>
    <artifactId>logback-classic</artifactId>
    <version>${org.logback.version}</version>
</dependency>
		
<!-- x38 -->
<dependency>
    <groupId>com.ejie.x38</groupId>
    <artifactId>x38ShLibClasses</artifactId>
    <version>1.1.0</version>
</dependency>
}}}
</li>
</li>
</ul>
</li>

<li>Modificar los ficheros de configuración de LOGBack ([http://code.google.com/p/uda/source/browse/wiki/files/logback-test.xml "logback-test.xml"] y [http://code.google.com/p/uda/source/browse/wiki/files/logback.xml "logback.xml"]) para aplicarles el código de aplicación que albergara el sistema de trazas cambiando el campo {{{<contextName>xxxx</contextName>}}} (situado al comienzo de los ficheros) con el código apropiado de aplicación (Ej. {{{<contextName>x21b</contextName>}}})

Copiar los ficheros en el proyecto/ruta correspondiente:
<ul>
<li>{{{logback-test.xml}}} en la carpeta {{{xxxEarClasses/src/}}}</li>
<li>{{{logback.xml}}} en la carpeta {{{xxxConfig/}}}</li>
</ul>


Borrar el fichero de configuración de log4j ({{{.properties}}}) del proyecto. 

Así, los proyectos deberían quedar como en las siguientes imágenes:

<img src="http://uda.googlecode.com/svn/wiki/images/img2.JPG"/>

<img src="http://uda.googlecode.com/svn/wiki/images/img3.JPG"/>

</li>

<li>Se deben modificar las propiedades que configuran el nuevo sistema de trazas. En el fichero de propiedades de la aplicación ({{{xxxConfig/xxx.properties}}}) se deberán añadir las siguientes líneas:

{{{
#Loggin parameters
log.path=c:/datos/xxx/log
log.level.salidaEstandar=INFO
log.level.UDATrazas=TRACE
log.level.aplicTrazas=INFO
log.level.auditoriaAccesos=INFO
}}}

Donde {{{log.path}}} indica la ruta del directorio que albergará los ficheros de trazas. 

NOTA: En EJIE, por normativa, la ubicación es "{{{datos/xxx/log}}}" (siendo xxx el código de aplicación).

El resto de propiedades indica el nivel de traza de cada uno de los ficheros que se genera.
</li>

<li>Para que la configuración de LOGBack sea cargada por Spring es necesario editar el fichero "{{{log-config.xml}}}" situado en la carpeta {{{spring}}} del directorio {{{src}}} del proyecto {{{EarClasses}}} de la aplicación.

<img src="http://uda.googlecode.com/svn/wiki/images/img5.JPG"/>

{{{
<!-- Se especifica la inicialización de los trazas mediante logback -->
<bean id="trazasystemInitializer" 
      class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">  

  <property name="staticMethod" value="com.ejie.x38.log.LogbackConfigurer.initLogging" />  
  <property name="arguments">  
    <list>  
       <!-- Se especifica la ubicación del fichero de configuración de logback (puede ser una ruta del classpath o absoluta) -->
       <value>XXX/logback.xml</value>

       <!-- Se especifica si se desea que se pinte el estado de la configuración de Logback por la salida de log correspondiente -->
       <value>true</value>
    </list>  
  </property>  
</bean>
}}}
</li>

<li>Cambiar toda referencia a log4j (imports y entradas de trazas) del código de la aplicación por el de SLF4J. Para ello se deberían hacer los siguientes cambios:

Los imports de log4j 

Antes:
{{{
import org.apache.log4j.Level;
import org.apache.log4j.Logger; 
}}}
Ahora:
{{{
import org.slf4j.LoggerFactory;
import org.slf4j.Logger;
}}}

Las instancias de los loggers 

Antes:
{{{
private static final  Logger  logger = Logger.getLogger(xxxServiceImpl.class);
}}}
Ahora:
{{{
private static final  Logger  logger = LoggerFactory.getLogger(xxxServiceImpl.class);
}}}

Cualquier traza incluida en el código con log4j debe ser adaptada a la sintaxis utilizada por slf4j. El cambio principal es la especificación del nivel de traza. :

Antes (log4j especifica el nivel como parámetro): 
{{{
logger.log(Level.ALL, "mensaje de ejemplo");
logger.log(Level.DEBUG, "mensaje de ejemplo");
logger.log(Level.ERROR, "mensaje de ejemplo");
logger.log(Level.FATAL, "mensaje de ejemplo");
logger.log(Level.INFO, "mensaje de ejemplo");
logger.log(Level.OFF, "mensaje de ejemplo");
logger.log(Level.TRACE, "mensaje de ejemplo");
logger.log(Level.WARN, "mensaje de ejemplo");
}}}

Ahora (SLF4J tiene un método específico para cada nivel de log):
{{{
logger.debug("mensaje de ejemplo");
logger.error("mensaje de ejemplo");
logger.info("mensaje de ejemplo");
logger.trace("mensaje de ejemplo");
logger.warn("mensaje de ejemplo");
}}}

Es importante tener en cuenta que los niveles que se pueden asociar a un mensaje de traza varían entre una tecnología y otra. Los más comunes coincidirán y solo habrá que cambiar el parámetro por la invocación al método correspondiente, pero en aquéllos que no coinciden habrá que adecuarlos convenientemente a SLF4J.

Para hacer este cambio de forma rápida y sencilla se recomienda utilizar la herramienta de reemplazo de código integrada en el Eclipse.

Con el Eclipse arrancado y dentro del WorkSpace donde se encuentra el código a adaptar, se debe presionar las teclas Ctrl+h. Esto sacará la ventana de búsquedas del Eclipse.

<img src="http://uda.googlecode.com/svn/wiki/images/img6.JPG"/>

En dicha ventana, se usará la pestaña "File Search" para realizar todos los cambios automáticos de código. Las búsquedas se deberán parametrizar sobre todos los ficheros indicando un {{{*}}} en el campo "File name patterns". Para cada búsqueda se indicará el texto a buscar en el campo "Containing text" y se presionará el botón "Replace". Se desencadenará una búsqueda sobre todo el código y se presentará una nueva ventana donde se solicita el texto a utilizar en el reemplazo. 

<img src="http://uda.googlecode.com/svn/wiki/images/img7.JPG"/>

Una vez especificado el texto a sustituir en el campo "With", se presionará el botón "Ok" para culminar el procedimiento. Si se desea visualizar los cambios que se van a realizar, y asegurarse de que todo va a marchar como debe, presionando el botón "Preview" se podrán visualizar los cambios que va a realizar el Eclipse.

<img src="http://uda.googlecode.com/svn/wiki/images/img8.JPG"/>

Una vez se entiende y comprende la herramienta que se va a utilizar las sustituciones que se deben realizar son las siguientes:

Buscar "{{{import org.apache.log4j.Level;}}}" y sustituir por "{{{import org.slf4j.LoggerFactory;}}}"

Buscar "{{{import org.apache.log4j.Logger;}}}" y sustituir por "{{{import org.slf4j.Logger;}}}"

Buscar "{{{Logger.getLogger}}}" y sustituir por "{{{LoggerFactory.getLogger}}}"

Buscar "{{{logger.log(Level.DEBUG,}}}" y sustituir por "{{{logger.debug(}}}"

Buscar "{{{logger.log(Level.ERROR,}}}" y sustituir por "{{{logger.error(}}}"

Buscar "{{{logger.log(Level.INFO,}}}" y sustituir por "{{{logger.info(}}}"

Buscar "{{{logger.log(Level.TRACE,}}}" y sustituir por "{{{logger.trace(}}}"

Buscar "{{{logger.log(Level.WARN,}}}" y sustituir por "{{{logger.warn(}}}"

Una vez realizadas las sustituciones anteriores, se habrá adaptado el 95% de los cambios. Llegados a este punto se deberán buscar los niveles de log4j que no cubre SLF4J para adaptarlos. Para ello se deberá buscar, mediante la herramienta de búsqueda (Ctrl.+ h), el texto "{{{logger.log(}}}"  y acceder a esos casos para realizar los cambios a mano. 

Es muy posible que en esta búsqueda aparezcan algunas ocurrencias de los niveles ya buscados por que el patrón de búsqueda utilizado difiere en algún espacio al utilizado en la aplicación. En estos casos, se debería ajustar el patrón de búsqueda y realizar de nuevo el reemplazo para ajustar el código de forma correcta. 
</li>
</ul>
</li>

<li>Existe la posibilidad de auditar los accesos a Base de Datos para conocer las consultas que se lanzan contra la Base de Datos y los datos que se devuelven. Por seguridad esta traza no se configura inicialmente en UDA pero a continuación se comentan los pasos a seguir de cara aplicar esta auditoría.

<ul>
<li>Añadir la librería necesaria {{{jdbcdslog-1.0.5.jar}}} al proyecto EAR (esta puede obtenerse desde el fichero de [http://uda.googlecode.com/files/MavenRepository-v1.1.0.zip repositorio Maven 1.1.0 suministrado])

<img src="http://uda.googlecode.com/svn/wiki/images/img9.JPG"/>

</li>

<li>
Modificar el fichero de configuración de propiedades "{{{xxx.properties}}}" para indicar el nivel de traza del fichero. Se debe añadir la siguiente línea:

{{{
log.level.auditoriaBBDD=INFO
}}}
</li>

<li>Se deberá incluir el {{{DataSource}}} que interceptará las peticiones a Base de Datos. Se deberá modificar el fichero "{{{dao-config.xml}}}" del proyecto {{{xxxEARClasses}}}.

{{{
<!--Configuration of dataSource with DDBB audit -->
<jee:jndi-lookup id="aplicDataSource" jndi-name="x21a.x21aDataSource" resource-ref="false"/>
	
<bean id="dataSource" class="org.jdbcdslog.ConnectionPoolDataSourceProxy">
      <property name="targetDSDirect" ref="aplicDataSource" />
</bean>
}}}

NOTA: En este ejemplo el {{{DataSource}}} al que se conecta es {{{x21a.x21aDataSource}}}

En el caso de tratarse de un proyecto JPA hay que hacer un par de modificaciones:

<ul>
<li>Añadir la cabecera "{{{xmlns:jee}}}" para soportar la etiqueta {{{<jee>}}}:

{{{
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
xmlns:jee="http://www.springframework.org/schema/jee"
xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context
   http://www.springframework.org/schema/context/spring-context-3.0.xsd
   http://www.springframework.org/schema/jee
   http://www.springframework.org/schema/jee/spring-jee-3.0.xsd">
}}}
</li>
<li>Añadir la propiedad "{{{dataSource}}}":
    
{{{
<!-- Configuration of the JPA Management  -->
<bean id="jtaEntityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="XXX_JTA" />
        <property name="dataSource" ref="dataSource" />
        <property name="persistenceXmlLocation" value="classpath:udaPersistence.xml" />
        <property name="loadTimeWeaver">
            <bean class="org.springframework.instrument.classloading.weblogic.WebLogicLoadTimeWeaver" />
        </property>
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter">
                <property name="database" value="ORACLE" />
                <property name="showSql" value="true" />
            </bean>
        </property>
</bean>
}}}
</li>
</ul>
</li>

<li>Modificar el fichero "{{{xxxConfig/logback.xml}}}" para incluir el {{{appender}}} y los {{{loggers}}} necesarios para generar las trazas.

{{{
<appender name="auditoriaBBDDAppender" class="ch.qos.logback.core.rolling.RollingFileAppender">
	
        <File>${log.path}/auditoriaBBDD_${CONTEXT_NAME}_${weblogic.Name}.log</File>
	<filter class="com.ejie.x38.log.UdaLogFilter"/>
	<encoder class="ch.qos.logback.core.encoder.LayoutWrappingEncoder">
		<layout class="com.ejie.x38.log.LogLayout">
			<appCode>${CONTEXT_NAME}</appCode>
	     		<instance>${weblogic.Name}</instance>	
		</layout>
	</encoder>
	<rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
	
        <!-- rollover daily -->
        <fileNamePattern>${log.path}/auditoriaBBDD_${CONTEXT_NAME}_${weblogic.Name}.%d{yyyy-MM-dd}.%i.gz</fileNamePattern>

        <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
	<maxFileSize>100MB</maxFileSize>
	</timeBasedFileNamingAndTriggeringPolicy>
	
        <!-- 7-day history -->
      	<maxHistory>6</maxHistory>
	</rollingPolicy>
</appender>

<logger name="org.jdbcdslog" level="${log.level.auditoriaBBDD}" additivity="false">
       <appender-ref ref="auditoriaBBDDAppender"/>
</logger>
<logger name="org.eclipse.persistence-connection" level="${log.level.auditoriaBBDD}" 
    additivity="false">
       <appender-ref ref="auditoriaBBDDAppender"/>
</logger>
<logger name="org.eclipse.persistence" level="${log.level.auditoriaBBDD}" 
    additivity="false">
	<appender-ref ref="auditoriaBBDDAppender"/>
</logger>
}}}
</li>
</ul>
</li>
</ol>

<h3>v1.0.1 (09-Julio-2011)</h3>
<ol>
<li>Cambiar la carpeta {{{<APP>}}}Statics\WebContent\rup por la carpeta incluida en el fichero [http://uda.googlecode.com/files/rup-v1.0.1.zip rup-v1.0.1.zip]</li>
<li>Modificar la inclusión de los ficheros CSS (template) y JS (base-includes):

    {{{<xxxYYY>}}}War\WebContent\WEB-INF\layouts\template.jsp (líneas 17-32):
{{{
<!-- Patrones (basic-theme) -->
<link href="${staticsUrl}/rup/basic-theme/theme.rup.base-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.autocomplete-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.breadCrumb-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.combo-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.date-1.0.0.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.feedback-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.grid-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.lang-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.maint-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.menu-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.messages-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.tabs-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.time-1.0.0.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.toolbar-1.0.1.css" rel="stylesheet" type="text/css" />
<link href="${staticsUrl}/rup/basic-theme/theme.rup.tooltip-1.0.0.css" rel="stylesheet" type="text/css" />
}}}
			
    **NOTA: En caso de tener templateVertical.jsp o templateMixto.jsp el cambio sería idéntico

    {{{<xxxYYY>}}}\WebContent\WEB-INF\layouts\base-includes.jsp (líneas 15-56):
{{{
<!-- jQuery 1.4.4 -->
<script src="${staticsUrl}/rup/scripts/core/jquery-1.4.4.js" type="text/javascript"></script>

<!-- RUP-CORE -->
<script src="${staticsUrl}/rup/scripts/rup.utils-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.base-1.0.1.js" type="text/javascript"></script>

<!-- jQuery UI 1.8.11 (+ patrones subyacentes) -->
<script src="${staticsUrl}/rup/scripts/core/jquery.blockUI.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/xbreadcrumbs.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/ui/jquery-ui-1.8.11.custom.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/ui/jquery.ui.autocomplete.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/ui/jquery.ui.menu.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/ui/jquery-ui.multidatespicker.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/ui/jquery.ui.selectmenu.js" type="text/javascript"></script><!-- combo -->
<script src="${staticsUrl}/rup/scripts/core/ui/jquery-ui.timepicker.js" type="text/javascript"></script>
	
<!-- jqGrid 3.8.1 -->
<script src="${staticsUrl}/rup/scripts/core/jqGrid.min-3.8.1.js" type="text/javascript"></script>
   
<!-- Utilidades adicionales -->
<script src="${staticsUrl}/rup/scripts/core/jquery.form.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/jquery.json-2.2.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/form2object.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/core/jquery.numeric.js" type="text/javascript"></script>

<!-- Patrones RUP -->
<script src="${staticsUrl}/rup/scripts/rup.autocomplete-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.breadCrumb-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.combo-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.date-1.0.0.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.dialog-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.feedback-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.grid-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.lang-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.maint-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.menu-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.message-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.tabs-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.time-1.0.0.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.toolbar-1.0.1.js" type="text/javascript"></script>
<script src="${staticsUrl}/rup/scripts/rup.tooltip-1.0.0.js" type="text/javascript"></script>
}}}
</li>			
<li>Añadir la siguiente cabecera para soporte nativo de IE8 en templates.jsp (línea 8):

{{{
<meta http-equiv="X-UA-Compatible" content="IE=8" />
}}}
	
    **NOTA: En caso de tener templateVertical.jsp o templateMixto.jsp el cambio sería idéntico
</li>	

<li>Actualizar el fichero [http://uda.googlecode.com/svn/wiki/files/security-core-config.xml "security-core-config.xml"] (a nivel de WAR)

    **NOTA: Este fichero no está disponible en la sección de "downloads", por tanto, decárgatelo desde el enlace anterior.
</li>
<li>Aumentar el tiempo de cacheo en el fichero "security-config.xml" (a nivel de WAR) de 2 a 120 para cuando se usa el wrapper de n38 (línea 7):

{{{
<property name="xlnetCachingPeriod" value="120" />
}}}
	
    **NOTA: Antes la configuración era en minutos y actualmente el valor es en segundos
</li>

<li>Modificar el pom.xml del EAR para permitir SNAPSHOT del repositorio de OTC {{{"<enabled>true</enabled>"}}} (línea 160):

{{{
<repositories>
    <repository>
	<id>ejie</id>
	<name>ejie</name>
	<url>http://www.otc.ejiedes.net/archiva/repository/repoEJIE</url>
	<snapshots>
		<enabled>true</enabled>
	</snapshots>
    </repository>
</repositories>
}}}
</li>
<li>Actualizar x38ShLibClasses a la versión 1.0.1 [http://uda.googlecode.com/files/x38ShLibClasses-1.0.1.jar x38ShLibClasses-1.0.1.jar]. Puedes copiar directamente la librería sobre el subdirectorio APP-INF/lib del EAR, o bien seguir estos pasos (recomendado):
<ul>
<li>En el fichero pom.xml del EAR actualiza la versión de x38:
{{{
<dependency>
<groupId>com.ejie.x38</groupId>
<artifactId>x38ShLibClasses</artifactId>
<version>1.0.1</version>
</dependency>
}}}
</li>
<li>Abre el build.xml del proyecto EAR con el editor ant (botón derecho sobre el fichero, Open With>Ant Editor)</li>
<li>Ejecuta la tarea "mavenRunDependencies" (botón derecho sobre la tarea, Run As>Ant Build)</li>
</ul>
</li>
<li>Para no tener problemas con los caracteres acentuados, eñes, etc. incluye en el fichero web.xml de todos tus WARs lo siguiente (línea 5):
{{{
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jsp</url-pattern>
        <page-encoding>UTF-8</page-encoding>
    </jsp-property-group>
</jsp-config>
}}}
</li>
<li>A partir de la versión 1.0.1 los mantenimientos no requieren que el identificador de su capa comience con "{{{EJIE_MAINT_}}}". Debido a este cambio es posible que sea necesario realizar las siguientes modificaciones en las páginas que utilicen el componente mantenimiento:
<ul>
<li>En las jsp creadas de acuerdo a la versión 1.0.0 el identificador de la capa del mantenimiento será "EJIE_MAINT_nombre", siendo "nombre" el literal identificador del mantenimiento. De acuerdo a los cambios realizados el identificador de la capa deberá ser "nombre". Por ejemplo sustiuir {{{<div id="EJIE_MAINT_usuarios">}}} por {{{<div id="usuarios">}}}.</li>
<li>Del mismo modo, se deberá de modificar en el fichero js asociado a la jsp, la llamada que se realiza para la construcción del componente mantenimiento de modo que se referencie correctamente al nuevo identificador. Siguiendo el mismo ejemplo, se debería de modificar la llamada existente {{{$("#EJIE_MAINT_usuarios").rup_maint(}}} por {{{$("#usuarios").rup_maint(}}}</li>
</ul>
</li>
</ol>